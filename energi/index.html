<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Usaha dan Energi</title>

    <!-- Gunakan Comic Neue dari Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Comic Neue', cursive;
            background: linear-gradient(135deg, #f0f2f5 0%, #e6ecef 100%);
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            margin: 0;
            min-height: 100vh;
        }

        h1 {
            color: #007bff;
            font-weight: 700;
            font-size: 2.2rem;
            margin-bottom: 30px;
            text-shadow: 0 2px 4px rgba(0, 123, 255, 0.1);
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
            max-width: 1200px;
            gap: 25px;
        }

        .panel {
            background: #ffffff;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .controls {
            flex-basis: 300px;
            flex-grow: 1;
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
        }

        .controls h2 {
            margin-top: 0;
            border-bottom: 2px solid #007bff;
            padding-bottom: 12px;
            color: #333;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: #333;
        }

        .control-group input[type="range"],
        .control-group select {
            width: 100%;
            cursor: pointer;
            accent-color: #007bff;
            background: #e9ecef;
            border-radius: 5px;
            padding: 5px;
        }

        .control-group select {
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .control-group select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        }

        .control-group span {
            font-weight: 700;
            font-size: 1.1em;
            color: #007bff;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            margin-right: 10px;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        button#resetButton {
            background-color: #ffeb3b;
            color: #333;
        }

        button#resetButton:hover {
            background-color: #ffd700;
            transform: translateY(-2px);
        }

        .simulation-area {
            flex-basis: 700px;
            flex-grow: 2;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        canvas {
            background: #ffffff;
            border: 1px solid #ced4da;
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        #energy-charts {
            display: flex;
            justify-content: space-around;
            height: 200px;
            padding: 15px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .chart {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 30%;
        }

        .bar-container {
            width: 70px;
            height: 120px;
            background: #e9ecef;
            border: 1px solid #ced4da;
            position: relative;
            overflow: hidden;
            border-radius: 5px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .bar {
            width: 100%;
            position: absolute;
            bottom: 0;
            left: 0;
            transition: height 0.2s ease;
        }

        #pe-bar { background-color: #28a745; }
        #ke-bar { background-color: #dc3545; }
        #total-bar { background-color: #007bff; }

        .chart-label {
            font-size: 0.95em;
            font-weight: 700;
            margin-top: 8px;
            text-align: center;
            color: #333;
        }

        .chart-value {
            font-size: 1.1em;
            font-weight: 700;
            margin-top: 6px;
            color: #333;
            /* Tetap gunakan Comic Neue agar konsisten */
        }

        /* Form Jawaban Siswa */
        #studentAnswer {
            width: 100%;
            padding: 12px;
            font-family: 'Comic Neue', cursive;
            font-size: 1rem;
            border: 1px solid #ced4da;
            border-radius: 8px;
            resize: vertical;
        }

        #submitAnswer {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            transition: background-color 0.3s ease;
        }

        #submitAnswer:hover {
            background-color: #218838;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>

    <h1>Simulasi Usaha dan Energi (Tanpa Gesekan)</h1>
    
    <div class="container">
        <div class="panel controls">
            <h2>Panel Kontrol</h2>
            
            <div class="control-group">
                <label for="objectSelect">Pilih Objek: <span id="objectValue">Bola</span></label>
                <select id="objectSelect">
                    <option value="ball">Bola</option>
                    <option value="car">Mobil</option>
                    <option value="motorcycle">Motor</option>
                    <option value="bicycle">Sepeda</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="hSlider">Ketinggian (h): <span id="hValue">10</span> m</label>
                <input type="range" id="hSlider" min="1" max="15" value="10" step="0.5">
            </div>
            
            <div class="control-group">
                <label for="mSlider">Massa (m): <span id="mValue">5</span> kg</label>
                <input type="range" id="mSlider" min="1" max="20" value="5" step="0.5">
            </div>
            
            <button id="startButton">Mulai!</button>
            <button id="resetButton">Reset</button>
        </div>
        
        <div class="panel simulation-area">
            <canvas id="simCanvas" width="700" height="400"></canvas>
            
            <div id="energy-charts">
                <div class="chart">
                    <div class="bar-container"><div class="bar" id="pe-bar"></div></div>
                    <div class="chart-label">Energi Potensial (PE)</div>
                    <div class="chart-value" id="pe-value">0.0 J</div>
                </div>
                <div class="chart">
                    <div class="bar-container"><div class="bar" id="ke-bar"></div></div>
                    <div class="chart-label">Energi Kinetik (KE)</div>
                    <div class="chart-value" id="ke-value">0.0 J</div>
                </div>
                <div class="chart">
                    <div class="bar-container"><div class="bar" id="total-bar"></div></div>
                    <div class="chart-label">Total Energi</div>
                    <div class="chart-value" id="total-value">0.0 J</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Elemen DOM
            const canvas = document.getElementById('simCanvas');
            const ctx = canvas.getContext('2d');
            const hSlider = document.getElementById('hSlider');
            const mSlider = document.getElementById('mSlider');
            const hValue = document.getElementById('hValue');
            const mValue = document.getElementById('mValue');
            const objectSelect = document.getElementById('objectSelect');
            const objectValue = document.getElementById('objectValue');
            const startButton = document.getElementById('startButton');
            const resetButton = document.getElementById('resetButton');
            const peBar = document.getElementById('pe-bar');
            const keBar = document.getElementById('ke-bar');
            const totalBar = document.getElementById('total-bar');
            const peValue = document.getElementById('pe-value');
            const keValue = document.getElementById('ke-value');
            const totalValue = document.getElementById('total-value');

            // Konstanta fisika dan skala
            const g = 9.81;
            const PIXEL_SCALE = 20;
            const rampStartX = 50;
            const rampEndX = 350;
            const groundY = 350;
            const rampWidth = rampEndX - rampStartX;
            const IMAGE_WIDTH = 40;

            // Rentang massa per objek
            const massRanges = {
                ball: { min: 1, max: 20, default: 5, step: 0.5 },
                car: { min: 100, max: 300, default: 200, step: 1 },
                motorcycle: { min: 80, max: 100, default: 90, step: 1 },
                bicycle: { min: 20, max: 40, default: 30, step: 1 }
            };

            // Gambar
            const backgroundImage = new Image();
            backgroundImage.src = 'https://blogger.googleusercontent.com/img/a/AVvXsEhEoCBc6nBqPgX_2C2P-J7x1PgPbxjDm9iyyjLWcsqx2zI1aM0iQ9UsBJ01lwcVh6mN8T8_DsXq9GUXpUzXolCpIUx3FBWJS2EW8ao9mYXt2AoLyA-A3MeGBz7C79xnDiVOSAbtA4XGUEfUJQOIXj7K3cJHtawVUaNjtwNiQEojLptk5zxUBChPz51_Vlw';

            const objectImages = {
                ball: null,
                car: new Image(),
                motorcycle: new Image(),
                bicycle: new Image()
            };
            objectImages.car.src = 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhs1xUImSguoMA27uMB7vWXNM7QE4sRGE3JfvV9Lgp2XIVe2xV-_Wfj3ZaDp26-7SOAj40ERmiOC30BZWEhijRa8AwTwK3Nd65OhEJvgYY-7JNBiifepvnK1XG5_mOwjE9XhodWbeQ4OBFIHAaBNaqrNp1Vz9t7_K5wUJbYQ8Y1VcjSTXakZeywqKbD1s4/s1600/gambar_mobil-removebg-preview.png';
            objectImages.motorcycle.src = 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjLPiDc7D9JqlU387L4gZLMCJoTVvbOFG3sHV4KJ7Oybfbe92ZBaIT7nNxbHPWkAsFOWRvMonOvwnjgT0VBS9jUoEXNvMm9TdJtw9OK929foCoeZ5tw5EgQIfEbQX5KrgPmfDYWtI0jVVPC5RQ0t0ccYKzuLMUt9PPc1Cs_YVh5bVvxlyfF5vh17lfUGa8/s1600/download-removebg-preview.png';
            objectImages.bicycle.src = 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdFy5ad0stbvVdXX21PRL5jGyq-hxYAM-_3I5NP_AQTmwys6-WInmJqFgfw10JbfgTSqlwI0dtOPxN0caKHnnuey2Os012_PPEyLAvwkyjpybEFOEQnbeGe6Zc5tKYuqEPv2LSyYWtHdQ3ZEUqt1RxED_oG-wB-pg6lAr-tNGFSHIS86fz_mrGcXWRI98/s1600/sepedah-removebg-preview.png';

            // State simulasi
            let ball = { x: rampStartX, y: 0, radius: 10, mass: 5, v: 0, type: 'ball' };
            let simState = { h_world: 10, isRunning: false, lastTime: 0, rampStartY: 0, rampAngle: 0 };
            let energy = { pe: 0, ke: 0, total: 0 };
            let animationFrameId = null;

            function updateMassSlider() {
                const type = objectSelect.value;
                const range = massRanges[type];
                mSlider.min = range.min;
                mSlider.max = range.max;
                mSlider.step = range.step;
                const currentVal = parseFloat(mSlider.value);
                const clampedVal = Math.max(range.min, Math.min(range.max, currentVal));
                mSlider.value = clampedVal === currentVal ? currentVal : range.default;
                ball.mass = parseFloat(mSlider.value);
                mValue.textContent = ball.mass.toFixed(1);
            }

            function resetSimulation() {
                if (animationFrameId) cancelAnimationFrame(animationFrameId);
                simState.isRunning = false;
                simState.lastTime = 0;

                ball.type = objectSelect.value;
                objectValue.textContent = objectSelect.options[objectSelect.selectedIndex].text;

                updateMassSlider();

                simState.h_world = parseFloat(hSlider.value);
                hValue.textContent = simState.h_world.toFixed(1);

                ball.radius = ball.type === 'ball' 
                    ? Math.max(8, Math.min(20, ball.mass * 0.8)) 
                    : IMAGE_WIDTH / 2;

                const h_pixel = simState.h_world * PIXEL_SCALE;
                simState.rampStartY = groundY - h_pixel;
                simState.rampAngle = Math.atan2(h_pixel, rampWidth);

                ball.x = rampStartX;
                ball.y = simState.rampStartY;
                ball.v = 0;

                energy.pe = ball.mass * g * simState.h_world;
                energy.ke = 0;
                energy.total = energy.pe;

                draw();
                updateEnergyDisplay();
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                if (backgroundImage.complete && backgroundImage.naturalWidth) {
                    ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);
                } else {
                    ctx.fillStyle = '#fdfdfd';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                }

                ctx.beginPath();
                ctx.moveTo(rampStartX, simState.rampStartY);
                ctx.lineTo(rampEndX, groundY);
                ctx.lineTo(canvas.width - 20, groundY);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 3;
                ctx.stroke();

                if (ball.type === 'ball') {
                    ctx.beginPath();
                    ctx.arc(ball.x, ball.y - ball.radius, ball.radius, 0, Math.PI * 2);
                    ctx.fillStyle = '#007bff';
                    ctx.fill();
                    ctx.strokeStyle = '#0056b3';
                    ctx.stroke();
                } else if (objectImages[ball.type].complete && objectImages[ball.type].naturalWidth) {
                    const img = objectImages[ball.type];
                    const aspectRatio = img.naturalHeight / img.naturalWidth;
                    const imgWidth = IMAGE_WIDTH;
                    const imgHeight = imgWidth * aspectRatio;
                    ctx.drawImage(img, ball.x - imgWidth / 2, ball.y - imgHeight - ball.radius, imgWidth, imgHeight);
                } else {
                    ctx.beginPath();
                    ctx.arc(ball.x, ball.y - ball.radius, ball.radius, 0, Math.PI * 2);
                    ctx.fillStyle = '#ff0000';
                    ctx.fill();
                }
            }

            function updateEnergyDisplay() {
                const maxE = energy.total || 1;
                peBar.style.height = (energy.pe / maxE * 100) + '%';
                keBar.style.height = (energy.ke / maxE * 100) + '%';
                totalBar.style.height = '100%';
                peValue.textContent = energy.pe.toFixed(1) + ' J';
                keValue.textContent = energy.ke.toFixed(1) + ' J';
                totalValue.textContent = energy.total.toFixed(1) + ' J';
            }

            function updatePhysics(dt) {
                if (dt > 0.1) dt = 0.1;
                const a = g * Math.sin(simState.rampAngle);
                ball.v += a * dt;
                const ds = ball.v * dt;
                ball.x += ds * Math.cos(simState.rampAngle);
                ball.y += ds * Math.sin(simState.rampAngle);

                if (ball.y >= groundY) {
                    ball.y = groundY;
                    ball.x = rampEndX + (ball.x - rampEndX);
                }

                if (ball.x >= canvas.width - 50) {
                    ball.x = canvas.width - 50;
                    ball.v = 0;
                    simState.isRunning = false;
                }

                const currentH = Math.max(0, (groundY - ball.y) / PIXEL_SCALE);
                energy.pe = ball.mass * g * currentH;
                energy.ke = energy.total - energy.pe;
            }

            function simulationLoop(currentTime) {
                if (!simState.isRunning) return;
                if (!simState.lastTime) simState.lastTime = currentTime;
                const dt = (currentTime - simState.lastTime) / 1000;
                updatePhysics(dt);
                draw();
                updateEnergyDisplay();
                simState.lastTime = currentTime;
                animationFrameId = requestAnimationFrame(simulationLoop);
            }

            function startSimulation() {
                if (simState.isRunning) return;
                simState.isRunning = true;
                simState.lastTime = 0;
                animationFrameId = requestAnimationFrame(simulationLoop);
            }

            startButton.addEventListener('click', startSimulation);
            resetButton.addEventListener('click', resetSimulation);

            hSlider.addEventListener('input', () => {
                simState.h_world = parseFloat(hSlider.value);
                hValue.textContent = simState.h_world.toFixed(1);
                resetSimulation();
            });

            mSlider.addEventListener('input', () => {
                ball.mass = parseFloat(mSlider.value);
                mValue.textContent = ball.mass.toFixed(1);
                resetSimulation();
            });

            objectSelect.addEventListener('change', () => {
                resetSimulation();
            });

            Promise.all([
                new Promise(r => backgroundImage.onload = r),
                new Promise(r => objectImages.car.onload = r),
                new Promise(r => objectImages.motorcycle.onload = r),
                new Promise(r => objectImages.bicycle.onload = r)
            ]).catch(() => {}).finally(() => {
                resetSimulation();
            });
        });
    </script>

    <!-- Form Jawaban Siswa -->
    <div class="panel" style="width: 100%; max-width: 1200px; margin-top: 30px; padding: 25px;">
        <h2>Jawaban Siswa</h2>
        <textarea id="studentAnswer" rows="6" placeholder="Jelaskan pengaruh perubahan massa dan ketinggian terhadap energi potensial dan energi kinetik berdasarkan simulasi yang telah kamu amati..."></textarea>
        <br><br>
        <div style="text-align: center;">
            <button id="submitAnswer">Kirim Jawaban</button>
        </div>

        <div id="teacherAnswer" style="display: none; margin-top: 25px; padding: 20px; background: #f8f9fa; border-left: 4px solid #007bff; border-radius: 8px;">
            <h3 style="margin-top: 0; color: #007bff;">Kesimpulan Simulasi Usaha dan Energi</h3>
            <p style="line-height: 1.7;">
                Melalui simulasi usaha dan energi, dapat disimpulkan bahwa energi potensial suatu benda bergantung pada massa dan ketinggiannya yang dirumuskan dengan Ep = m·g·h. Semakin besar massa benda atau semakin tinggi posisi benda, maka semakin besar pula energi potensial yang dimilikinya.
            </p>
            <p style="line-height: 1.7;">
                Ketika benda bergerak turun dari ketinggian, energi potensial tersebut berubah menjadi energi kinetik. Akibatnya, semakin tinggi posisi awal benda, maka semakin besar energi kinetik yang diperoleh sehingga benda akan bergerak lebih cepat saat mendekati tanah. Hal ini sesuai dengan teori kekekalan energi, yaitu energi tidak hilang, melainkan berubah bentuk dari energi potensial menjadi energi kinetik.
            </p>
            <p style="line-height: 1.7;">
                Selain itu, meskipun dua benda jatuh dari ketinggian yang sama, benda yang memiliki massa lebih besar akan memiliki energi potensial dan energi kinetik yang lebih besar. Namun, percepatannya tetap sama karena percepatan gravitasi tidak dipengaruhi massa. Yang membedakan adalah gaya dan energi yang bekerja pada setiap benda.
            </p>
            <p style="line-height: 1.7;">
                Dengan demikian, simulasi ini memperkuat konsep bahwa usaha yang dilakukan oleh gaya gravitasi pada benda menyebabkan perubahan energi, dan hubungan antara ketinggian, massa, energi potensial, serta energi kinetik dapat diamati secara jelas melalui pergerakan benda dalam simulasi tersebut.
            </p>
            <div style="text-align: center;">
                <button onclick="window.location.href='../simulasi.html'">Latihan Soal dan Kuis</button>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('submitAnswer').addEventListener('click', function() {
            const studentText = document.getElementById('studentAnswer').value.trim();
            if (studentText === '') {
                alert('Silakan tulis jawabanmu terlebih dahulu!');
                return;
            }
            document.getElementById('teacherAnswer').style.display = 'block';
        });
    </script>
</body>
</html>